<div class="dashboard">
    <!-- البنر المتحرك -->
    <div class="animated-banner">
        <div class="banner-content">
            <div class="banner-item">
                <span class="banner-icon"><i data-feather="gift"></i></span>
                <span>احصل على نقاط هدايا مع كل عملية شراء!</span>
            </div>
            <div class="banner-item">
                <span class="banner-icon"><i data-feather="award"></i></span>
                <span>استبدل نقاطك بكروت مجانية مجانية</span>
            </div>
            <div class="banner-item">
                <span class="banner-icon"><i data-feather="percent"></i></span>
                <span>عروض خاصة على جميع الباقات</span>
            </div>
            <div class="banner-item">
                <span class="banner-icon"><i data-feather="credit-card"></i></span>
                <span>اشحن رصيدك واحصل على خصومات</span>
            </div>
        </div>
    </div>

    <!-- شعار مدى كاش -->
    <div class="logo-container">
        <img src="https://blogger.googleusercontent.com/img/a/AVvXsEjTrPsM0K0wOW-A5jS_YZLr9W8Zb-ge8hTM46lJBmwHTCC6kDT6Xh7dBgMG4ysuFoKKyegl7tk97ccltDiWN0VpiFksCrbU89pdcdXuYvhgbOnfvypFGGVF3qaj1IK56q5jBhA_WqnYGaVPfE8qRVq8FPz4PMeBM_LnoHGnzB4Ug3_oSw_aGlSxoO97Yog" alt="شعار مدى كاش" class="dashboard-logo">
    </div>

    <!-- Header -->
    <div class="dashboard-header">
        <div class="container">
            <div class="header-top">
                <div class="user-info">
                    <h2 id="userName">مرحبًا.. </h2>
                    <div class="user-code">
                        <span> الكود المميز الخاص بك: <span id="userCode"></span></span>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="notification-btn" onclick="toggleNotifications()">
                        <i data-feather="bell"></i>
                        <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
                    </button>
                    <button class="logout-btn" onclick="logout()"><i data-feather="log-out"></i></button>
                </div>
            </div>

            <div class="balance-cards">
                <!-- بطاقة موحدة مقسمة إلى قسمين -->
                <div class="unified-balance-card">
                    <div class="balance-section" onclick="showBalanceStats()" style="cursor: pointer;">
                        <div class="balance-label"><i data-feather="dollar-sign"></i> رصيدك الحالي</div>
                        <div class="balance-amount" id="userBalance">0 ريال</div>
                    </div>
                    <div class="balance-section" onclick="showTab('points')" style="cursor: pointer;">
                        <div class="balance-label"><i data-feather="gift"></i> لديك نقاط هدايا</div>
                        <div class="balance-amount" id="userPoints">0 نقطة</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- لوحة التنبيهات -->
    <div id="notificationsPanel" class="notifications-panel">
        <div class="notifications-header">
            <div class="notifications-title"><i data-feather="bell"></i> التنبيهات</div>
            <button class="close-notifications" onclick="closeNotifications()"><i data-feather="x"></i></button>
        </div>
        <div class="notifications-actions">
            <div style="color: #666; font-size: 13px; font-weight: 500;">
                <span id="notificationsCount">0 تنبيه</span>
            </div>
            <button class="delete-all-btn" onclick="showConfirm('مسح جميع التنبيهات', 'هل تريد مسح جميع التنبيهات؟ لا يمكن التراجع عن هذا الإجراء.', deleteAllNotifications)">
                <i data-feather="trash-2"></i> مسح الكل
            </button>
        </div>
        <div id="notificationsList" class="notifications-list">
            <div class="loading"><div class="spinner"></div></div>
        </div>
    </div>

    <!-- Navigation -->
    <div class="nav-tabs">
        <div class="nav-tab active" onclick="showTab('packages')">
            <span class="tab-icon"><i data-feather="package"></i></span>
            <div>الباقات</div>
        </div>
        <div class="nav-tab" onclick="showTab('myCards')">
            <span class="tab-icon"><i data-feather="credit-card"></i></span>
            <div>كروتي</div>
        </div>
        <div class="nav-tab" onclick="showTab('points')">
            <span class="tab-icon"><i data-feather="gift"></i></span>
            <div>نقاطي</div>
        </div>
        <div class="nav-tab" onclick="showTab('recharge')">
            <span class="tab-icon"><i data-feather="dollar-sign"></i></span>
            <div>الشحن</div>
        </div>
        <div class="nav-tab" onclick="showTab('transfer')">
            <span class="tab-icon"><i data-feather="refresh-cw"></i></span>
            <div>التحويل</div>
        </div>
        <div class="nav-tab" onclick="showTab('history')">
            <span class="tab-icon"><i data-feather="file-text"></i></span>
            <div>السجل</div>
        </div>
        <div class="nav-tab" onclick="showTab('profile')">
            <span class="tab-icon"><i data-feather="user"></i></span>
            <div>حسابي</div>
        </div>
    </div>

    <!-- Tab: الباقات -->
    <div id="packagesTab" class="tab-content active">
        <div class="content-wrapper">
            <h2 class="section-title"><i data-feather="package"></i> الباقات المتاحة</h2>
            <p class="section-subtitle">اختر الباقة المناسبة لاحتياجاتك واحصل على نقاط هدايا</p>
            <div id="packagesList" class="packages-grid">
                <div class="loading"><div class="spinner"></div></div>
            </div>
        </div>
    </div>

    <!-- Tab: كروتي - التصميم الجديد المبسط -->
    <div id="myCardsTab" class="tab-content">
        <div class="content-wrapper">
            <div class="cards-container">
                <h2 class="section-title"><i data-feather="credit-card"></i> كروتي</h2>
                <p class="section-subtitle">الكروت التي قمت بشرائها أو الحصول عليها من خلال النقاط</p>
                <div class="cards-stats" id="cardsStats">
                    <div class="loading"><div class="spinner"></div></div>
                </div>
                <div class="cards-list">
                    <h3 class="cards-list-title"><i data-feather="file-text"></i> قائمة كروتي</h3>
                    <div id="myCardsList">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: نقاط الهدايا - التصميم الجديد -->
    <div id="pointsTab" class="tab-content">
        <div class="content-wrapper">
            <div class="points-container">
                <div class="points-card">
                    <div class="points-title"><i data-feather="gift"></i> نقاط الهدايا الحالية</div>
                    <div class="points-value" id="currentPoints">0</div>
                    <div style="margin-top: 10px; font-size: 14px; opacity: 0.9; font-weight: 400;">
                        استمر في الشراء لجمع المزيد من النقاط والاستفادة من الهدايا!
                    </div>
                </div>

                <h2 class="section-title"><i data-feather="award"></i> كروت الهدايا</h2>
                <p class="section-subtitle">استبدل نقاطك بكروت مجانية</p>
                <div class="gifts-grid" id="giftsList">
                    <!-- سيتم ملؤها ديناميكياً -->
                </div>

                <div class="points-history">
                    <h3 class="points-history-title"><i data-feather="file-text"></i> سجل النقاط</h3>
                    <div id="pointsHistoryList">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: شحن الرصيد - مع زر QR code -->
    <div id="rechargeTab" class="tab-content">
        <div class="content-wrapper">
            <div class="recharge-container">
                <h2 class="section-title"><i data-feather="dollar-sign"></i> شحن الرصيد</h2>
                <p class="section-subtitle">استخدم بطاقة الشحن لإضافة رصيد إلى حسابك</p>

                <div class="recharge-form">
                    <h3 class="form-title">شحن الرصيد ببطاقة الشحن</h3>
                    <form id="rechargeForm">
                        <div class="form-group">
                            <label class="form-label">رقم بطاقة الشحن</label>
                            <div class="input-with-qr">
                                <input type="text" id="rechargeCardNumber" class="form-input" placeholder="أدخل رقم بطاقة الشحن" required>
                                <button type="button" class="qr-btn" onclick="openQRScanner()">
                                    <i data-feather="camera"></i> مسح QR
                                </button>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" id="rechargeBtn">
                            <i data-feather="dollar-sign"></i> شحن الرصيد
                        </button>
                    </form>
                </div>

                <div class="available-cards">
                    <h3 class="cards-title">البطاقات المتاحة للشحن</h3>
                    <div class="cards-grid-small" id="availableRechargeCards">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: التحويل -->
    <div id="transferTab" class="tab-content">
        <div class="content-wrapper">
            <div class="transfer-container">
                <h2 class="section-title"><i data-feather="refresh-cw"></i> تحويل الرصيد</h2>
                <p class="section-subtitle">قم بتحويل رصيدك إلى عملاء آخرين باستخدام الكود المميز</p>

                <div class="transfer-form">
                    <h3 class="form-title">تحويل الرصيد</h3>
                    <form id="transferForm">
                        <div class="form-group">
                            <label class="form-label">الكود المميز للمستلم</label>
                            <input type="text" id="recipientCode" class="form-input" placeholder="أدخل الكود المميز للمستلم" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">مبلغ التحويل (ريال)</label>
                            <input type="number" id="transferAmount" class="form-input" placeholder="أدخل المبلغ" required min="1">
                        </div>
                        <div class="form-group">
                            <label class="form-label">كلمة المرور للتأكيد</label>
                            <input type="password" id="transferPassword" class="form-input" placeholder="أدخل كلمة المرور" required>
                            <button type="button" class="password-toggle" onclick="togglePassword('transferPassword', this)">
                                <i data-feather="eye"></i>
                            </button>
                        </div>
                        <div class="save-favorite-checkbox">
                            <input type="checkbox" id="saveToFavorites">
                            <label for="saveToFavorites">حفظ بيانات المستفيد في المفضلة</label>
                        </div>
                        <button type="submit" class="btn btn-primary" id="transferBtn">
                            <i data-feather="refresh-cw"></i> تحويل الرصيد
                        </button>
                    </form>
                </div>

                <div class="favorite-recipients">
                    <h3 class="cards-title">المستفيدين المفضلين</h3>
                    <div id="favoriteRecipientsList">
                        <div class="loading"><div class="spinner"></div></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: السجل -->
    <div id="historyTab" class="tab-content">
        <div class="content-wrapper">
            <div class="transactions-list">
                <h2 class="section-title"><i data-feather="file-text"></i> سجل العمليات</h2>
                <p class="section-subtitle">عرض جميع عملياتك المالية</p>

                <div class="transactions-actions">
                    <div class="filter-container">
                        <select id="transactionsFilter" onchange="filterTransactions()">
                            <option value="all">جميع العمليات</option>
                            <option value="شحن">شحن الرصيد</option>
                            <option value="شراء">شراء الباقات</option>
                            <option value="حوالة صادرة">الحوالات الصادرة</option>
                            <option value="حوالة واردة">الحوالات الواردة</option>
                        </select>
                    </div>
                    <button class="save-pdf-btn" onclick="openSaveTransactionsModal()">
                        <i data-feather="download"></i> حفظ كملف PDF
                    </button>
                </div>

                <div id="transactionsList">
                    <div class="loading"><div class="spinner"></div></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Tab: حسابي -->
    <div id="profileTab" class="tab-content">
        <div class="content-wrapper">
            <div class="profile-container">
                <h2 class="section-title"><i data-feather="user"></i> حسابي</h2>
                <p class="section-subtitle">إدارة بياناتك الشخصية والإعدادات</p>

                <div class="profile-card">
                    <div class="profile-item">
                        <div class="profile-icon">
                            <i data-feather="user"></i>
                        </div>
                        <div class="profile-info">
                            <div class="profile-label">الاسم الكامل</div>
                            <div class="profile-value" id="profileName">-</div>
                        </div>
                    </div>

                    <div class="profile-item">
                        <div class="profile-icon">
                            <i data-feather="map-pin"></i>
                        </div>
                        <div class="profile-info">
                            <div class="profile-label">المنطقة</div>
                            <div class="profile-value" id="profileArea">-</div>
                        </div>
                    </div>

                    <div class="profile-item">
                        <div class="profile-icon">
                            <i data-feather="phone"></i>
                        </div>
                        <div class="profile-info">
                            <div class="profile-label">رقم الجوال</div>
                            <div class="profile-value" id="profilePhone">-</div>
                        </div>
                    </div>

                    <div class="profile-item">
                        <div class="profile-icon">
                            <i data-feather="credit-card"></i>
                        </div>
                        <div class="profile-info">
                            <div class="profile-label">رقم الحساب البنكي</div>
                            <div class="profile-value" id="profileBankAccount">-</div>
                        </div>
                    </div>

                    <div class="profile-item">
                        <div class="profile-icon">
                            <i data-feather="briefcase"></i>
                        </div>
                        <div class="profile-info">
                            <div class="profile-label">نوع البنك</div>
                            <div class="profile-value" id="profileBankType">-</div>
                        </div>
                    </div>

                    <button class="update-profile-btn" onclick="openUpdateProfileModal()">
                        <i data-feather="edit"></i> تحديث البيانات الشخصية
                    </button>
                </div>

                <div class="code-highlight" onclick="copyToClipboard('profileUniqueCode')">
                    <div class="profile-label">الكود المميز الخاص بك</div>
                    <div class="profile-value" id="profileUniqueCode">-</div>
                </div>

                <div class="profile-stats">
                    <h3 class="section-title" style="font-size: 22px; margin-top: 30px;"><i data-feather="bar-chart-2"></i> إحصائيات الحساب</h3>
                    <button class="btn btn-secondary" onclick="openBalanceStatsModal()" style="margin-top: 15px;">
                        <i data-feather="bar-chart-2"></i> عرض الإحصائيات الكاملة
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- نافذة تأكيد الشراء -->
<div id="purchaseConfirmModal" class="modal">
    <div class="modal-content">
        <h3 class="modal-title"><i data-feather="shopping-cart"></i> تأكيد الشراء</h3>
        <p class="confirm-message" id="purchaseConfirmMessage">هل أنت متأكد من شراء هذه الباقة؟</p>
        <div class="modal-actions">
            <button type="button" class="btn btn-primary" onclick="confirmPurchase()">
                <i data-feather="check"></i> تأكيد الشراء
            </button>
            <button type="button" class="btn btn-secondary" onclick="closePurchaseConfirmModal()">
                <i data-feather="x"></i> إلغاء
            </button>
        </div>
    </div>
</div>

<!-- نافذة نجاح الشراء -->
<div id="purchaseSuccessModal" class="modal purchase-success-modal">
    <div class="modal-content">
        <div class="success-icon">
            <i data-feather="check-circle"></i>
        </div>
        <h3 class="modal-title">تم الشراء بنجاح!</h3>
        <p class="confirm-message">تمت عملية الشراء بنجاح. رقم الكرت:</p>
        <div class="card-number-display">
            <div class="card-number" id="purchasedCardNumber"></div>
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-primary" onclick="copyPurchasedCardNumber()">
                <i data-feather="copy"></i> نسخ رقم الكرت
            </button>
            <button type="button" class="btn btn-secondary" onclick="closePurchaseSuccessModal()">
                <i data-feather="x"></i> إغلاق
            </button>
        </div>
    </div>
</div>

<!-- نافذة تأكيد التحويل -->
<div id="transferConfirmModal" class="modal">
    <div class="modal-content">
        <h3 class="modal-title"><i data-feather="refresh-cw"></i> تأكيد عملية التحويل</h3>
        <div class="transfer-details">
            <div class="transfer-detail-item">
                <span class="transfer-detail-label">اسم المستلم:</span>
                <span class="transfer-detail-value" id="confirmRecipientName">-</span>
            </div>
            <div class="transfer-detail-item">
                <span class="transfer-detail-label">الكود المميز:</span>
                <span class="transfer-detail-value" id="confirmRecipientCode">-</span>
            </div>
            <div class="transfer-detail-item">
                <span class="transfer-detail-label">مبلغ التحويل:</span>
                <span class="transfer-detail-value" id="confirmTransferAmount">-</span>
            </div>
        </div>
        <div class="form-group">
            <label class="form-label">كلمة المرور للتأكيد</label>
            <input type="password" id="confirmPassword" class="form-input" placeholder="أدخل كلمة المرور" required>
            <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword', this)">
                <i data-feather="eye"></i>
            </button>
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-primary" onclick="confirmTransfer()">
                <i data-feather="check"></i> تأكيد التحويل
            </button>
            <button type="button" class="btn btn-secondary" onclick="closeTransferConfirmModal()">
                <i data-feather="x"></i> إلغاء
            </button>
        </div>
    </div>
</div>

<!-- نافذة نجاح التحويل -->
<div id="transferSuccessModal" class="modal transfer-success-modal">
    <div class="modal-content">
        <div class="success-transfer-icon">
            <i data-feather="check-circle"></i>
        </div>
        <h3 class="modal-title">تم التحويل بنجاح!</h3>
        <div class="transfer-details-card">
            <div class="transfer-detail-row">
                <span class="transfer-detail-label">اسم المستلم:</span>
                <span class="transfer-detail-value" id="successRecipientName">-</span>
            </div>
            <div class="transfer-detail-row">
                <span class="transfer-detail-label">كود المستلم:</span>
                <span class="transfer-detail-value" id="successRecipientCode">-</span>
            </div>
            <div class="transfer-detail-row">
                <span class="transfer-detail-label">المبلغ المحول:</span>
                <span class="transfer-detail-value" id="successTransferAmount">-</span>
            </div>
            <div class="transfer-detail-row">
                <span class="transfer-detail-label">تاريخ التحويل:</span>
                <span class="transfer-detail-value" id="successTransferDate">-</span>
            </div>
        </div>
        <div class="transfer-actions">
            <button type="button" class="btn-share" id="sharePdfBtn">
                <i data-feather="share-2"></i> مشاركة كملف PDF
            </button>
            <button type="button" class="btn-copy" id="copyMessageBtn">
                <i data-feather="copy"></i> نسخ نص الرسالة
            </button>
            <button type="button" class="btn-close-transfer" onclick="closeTransferSuccessModal()">
                <i data-feather="x"></i> إغلاق
            </button>
        </div>
    </div>
</div>

<!-- نافذة تحديث الملف الشخصي -->
<div id="updateProfileModal" class="modal">
    <div class="modal-content">
        <h3 class="modal-title"><i data-feather="edit"></i> تحديث البيانات الشخصية</h3>
        <form id="updateProfileForm">
            <div class="form-sections">
                <div class="form-section">
                    <div class="section-title">
                        <i data-feather="user"></i>
                        المعلومات الأساسية
                    </div>
                    <div class="form-group">
                        <label class="form-label">الاسم الكامل</label>
                        <input type="text" id="updateName" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">المنطقة</label>
                        <input type="text" id="updateArea" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">رقم الجوال</label>
                        <input type="tel" id="updatePhone" class="form-input number-input" required maxlength="10">
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">
                        <i data-feather="lock"></i>
                        كلمة المرور
                    </div>
                    <div class="form-group">
                        <label class="form-label">كلمة المرور الحالية</label>
                        <input type="password" id="updateCurrentPassword" class="form-input">
                        <button type="button" class="password-toggle" onclick="togglePassword('updateCurrentPassword', this)">
                            <i data-feather="eye"></i>
                        </button>
                    </div>
                    <div class="form-group">
                        <label class="form-label">كلمة المرور الجديدة (اتركها فارغة إذا لم ترغب في التغيير)</label>
                        <input type="password" id="updatePassword" class="form-input" minlength="6">
                        <button type="button" class="password-toggle" onclick="togglePassword('updatePassword', this)">
                            <i data-feather="eye"></i>
                        </button>
                    </div>
                </div>

                <div class="form-section">
                    <div class="section-title">
                        <i data-feather="credit-card"></i>
                        المعلومات البنكية
                    </div>
                    <div class="form-group">
                        <label class="form-label">هل تملك حساب لدى شركات الصرافة ؟ </label>
                        <select id="updateBankType" class="form-input">
                            <option value="">اختر شركة الصرافة</option>
                            <option value="العمقي">العمقي</option>
                            <option value="الكريمي">الكريمي</option>
                            <option value="البسيري">البسيري</option>
                            <option value="بن دول">بن دول</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">رقم حسابك لدى شركة الصرافة </label>
                        <input type="text" id="updateBankAccount" class="form-input number-input">
                    </div>
                </div>
            </div>

            <div class="modal-actions">
                <button type="submit" class="btn btn-primary" id="updateProfileBtn">
                    <i data-feather="save"></i> حفظ التغييرات
                </button>
                <button type="button" class="btn btn-secondary" onclick="closeUpdateProfileModal()">
                    <i data-feather="x"></i> إلغاء
                </button>
            </div>
        </form>
    </div>
</div>

<!-- نافذة إحصائيات الرصيد -->
<div id="balanceStatsModal" class="modal simple-stats-modal">
    <div class="modal-content">
        <h3 class="modal-title"><i data-feather="bar-chart-2"></i> إحصائيات الرصيد</h3>
        <div class="simple-stats-list">
            <div class="stat-row">
                <span class="stat-label">الرصيد الحالي:</span>
                <span class="stat-value" id="currentBalanceStat">0 ريال</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">مبالغ بطاقات الشحن:</span>
                <span class="stat-value" id="totalRechargedStat">0 ريال</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">مبالغ الحوالات المستلمة:</span>
                <span class="stat-value" id="totalReceivedStat">0 ريال</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">مبالغ الحوالات الصادرة:</span>
                <span class="stat-value" id="totalSentStat">0 ريال</span>
            </div>
            <div class="stat-row">
                <span class="stat-label">عدد العمليات:</span>
                <span class="stat-value" id="totalTransactionsStat">0 عملية</span>
            </div>
        </div>
        <div class="stats-summary">
            <div class="summary-row">
                <span class="summary-label">صافي الحركة:</span>
                <span class="summary-value" id="netMovementStat">0 ريال</span>
            </div>
            <div class="summary-row">
                <span class="summary-label">آخر تحديث:</span>
                <span class="summary-value" id="lastUpdateStat">--</span>
            </div>
        </div>
        <div class="modal-actions">
            <button id="saveBalancePdfBtn" class="btn btn-secondary" onclick="saveBalanceStatsPDF()">
                <i data-feather="download"></i> حفظ PDF
            </button>
            <button class="btn btn-primary" onclick="closeBalanceStatsModal()">
                <i data-feather="check"></i> موافق
            </button>
        </div>
    </div>
</div>

<!-- نافذة مسح QR code -->
<div id="qrScannerModal" class="modal qr-scanner-modal">
    <div class="modal-content">
        <h3 class="modal-title"><i data-feather="camera"></i> مسح QR code</h3>
        <div class="qr-instructions">
            قم بتوجيه الكاميرا نحو رمز QR الخاص ببطاقة الشحن
        </div>
        <div class="qr-video-container">
            <video id="qrVideo" playsinline></video>
            <div class="qr-overlay"></div>
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-primary" onclick="stopQRScanner()">
                <i data-feather="x"></i> إغلاق الكاميرا
            </button>
        </div>
    </div>
</div>

<!-- نافذة حفظ السجل -->
<div id="saveTransactionsModal" class="modal date-picker-modal">
    <div class="modal-content">
        <h3 class="modal-title"><i data-feather="calendar"></i> حفظ سجل العمليات</h3>
        <p class="confirm-message">اختر الفترة الزمنية التي تريد حفظ العمليات فيها:</p>
        <div class="date-range-info">
            <div class="date-range-text" id="dateRangeInfo">حدد الفترة الزمنية</div>
        </div>
        <div class="date-picker-group">
            <label class="date-picker-label">من تاريخ:</label>
            <input type="date" id="transactionsStartDate" class="date-picker-input" required>
        </div>
        <div class="date-picker-group">
            <label class="date-picker-label">إلى تاريخ:</label>
            <input type="date" id="transactionsEndDate" class="date-picker-input" required>
        </div>
        <div class="period-summary" id="periodSummary" style="display: none;">
            <div class="period-title">ملخص الفترة المحددة</div>
            <div class="period-dates" id="periodDates"></div>
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-primary" onclick="generateTransactionsPDF()">
                <i data-feather="download"></i> حفظ كملف PDF
            </button>
            <button type="button" class="btn btn-secondary" onclick="closeSaveTransactionsModal()">
                <i data-feather="x"></i> إلغاء
            </button>
        </div>
    </div>
</div>

<!-- نافذة جاري إنشاء PDF -->
<div id="pdfGeneratingModal" class="modal pdf-generating-modal">
    <div class="modal-content">
        <div class="loading">
            <div class="spinner"></div>
        </div>
        <h3 class="modal-title">جاري إنشاء التقرير</h3>
        <p class="confirm-message">يرجى الانتظار أثناء إنشاء ملف PDF...</p>
    </div>
</div>

<!-- نافذة نجاح إنشاء PDF -->
<div id="pdfSuccessModal" class="modal pdf-success-modal">
    <div class="modal-content">
        <div class="success-icon">
            <i data-feather="check-circle"></i>
        </div>
        <h3 class="modal-title">تم إنشاء التقرير بنجاح!</h3>
        <div class="period-summary">
            <div class="period-title">الفترة المحددة</div>
            <div class="period-dates" id="successPeriodDates"></div>
        </div>
        <p class="confirm-message" id="pdfSuccessMessage">تم إنشاء التقرير يحتوي على <span id="transactionsCount">0</span> عملية</p>
        <button type="button" class="pdf-download-btn" id="downloadPdfBtn">
            <i data-feather="download"></i> تحميل ملف PDF
        </button>
        <button type="button" class="btn btn-secondary" onclick="closePdfSuccessModal()" style="margin-top: 10px;">
            <i data-feather="x"></i> إغلاق
        </button>
    </div>
</div>

<!-- نافذة نجاح الشحن -->
<div id="rechargeSuccessModal" class="modal recharge-success-modal">
    <div class="modal-content">
        <div class="success-icon">
            <i data-feather="check-circle"></i>
        </div>
        <h3 class="modal-title">تهانينا!</h3>
        <p class="confirm-message" id="rechargeSuccessMessage">تم إضافة الرصيد إلى حسابك بنجاح</p>
        <div class="modal-actions">
            <button type="button" class="btn btn-primary" onclick="closeRechargeSuccessModal()">
                <i data-feather="check"></i> موافق
            </button>
        </div>
    </div>
</div>

<!-- نافذة نجاح استبدال النقاط -->
<div id="redeemSuccessModal" class="modal purchase-success-modal">
    <div class="modal-content">
        <div class="success-icon">
            <i data-feather="gift"></i>
        </div>
        <h3 class="modal-title">تم الاستبدال بنجاح!</h3>
        <p class="confirm-message" id="redeemSuccessMessage">تم استبدال نقاطك بنجاح</p>
        <div class="card-number-display">
            <div class="card-number" id="redeemedCardNumber"></div>
        </div>
        <div class="modal-actions">
            <button type="button" class="btn btn-primary" onclick="copyRedeemedCardNumber()">
                <i data-feather="copy"></i> نسخ رقم الكرت
            </button>
            <button type="button" class="btn btn-secondary" onclick="closeRedeemSuccessModal()">
                <i data-feather="x"></i> إغلاق
            </button>
        </div>
    </div>
</div>

<script>
feather.replace();
</script>